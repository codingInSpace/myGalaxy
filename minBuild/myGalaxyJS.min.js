/*! galaxy-goose - v1.0.0 - 2015-07-20 */ 
function menusOnLogin(){$("#login").hide("fast"),$("#register").hide("fast"),$("#user_menu").show("fast"),$(".user_info").text(user.getUsername()),$("#sound-button-container").css({bottom:"120px"})}function menusOnLogout(){$("#user_menu").hide("fast"),$("#login").show("fast"),$("#register").show("fast"),$("#sound-button-container").css({bottom:"80px"})}function menusOnCreatePlanet(){$("#add-planet-button").hide(),$("#planet-info-container").hide(),$(".edit-created-planet-container").show("fast"),$("#jump-planet-button").show(),$("#jump-planet-moon-container").css({right:"240px"})}function menusOnSave(){$("#add-planet-button").show(),$(".edit-created-planet-container").hide("fast"),$("#jump-planet-button").show(),$("#jump-planet-moon-container").css({right:"120px"})}function menusOnPlanetActive(){$("#edit-planet-button").show()}function menusOnEditPlanet(){$("#add-planet-button").hide(),$("#edit-planet-button").hide(),$("#planet-info-container").hide(),$("#edit-planet-tabs").show(),$("#jump-planet-moon-container").hide()}function menusOnBuildPlanet(){$("#build-planet-button").hide(),$("#add-planet-button").hide(),$("#edit-planet-button").hide(),$("#planet-info-container").hide(),$("#accordion-container").show(),$("#jump-planet-moon-container").css({right:"240px"}),$("#jump-system-container").hide()}function menusOnEditDone(){$("#edit-planet-tabs").hide(),$("#accordion-container").hide(),$("#jump-system-container").show(),$("#jump-planet-moon-container").css({right:"120px"}),jumpPlanetOk||jumpMoonOk?$("#build-planet-button").show():($("#jump-planet-moon-container").show(),$("#edit-planet-button").show(),$("#add-planet-button").show())}function showButtonsForActivePlanet(){$("#edit-planet-button").is(":visible")||$("#edit-planet-button").show(),$("#jump-planet-button").show(),$("#jump-planet-moon-container").is(":visible")||($("#jump-planet-moon-container").show(),$("#jump-moon-button").hide())}function showPlanetInfoBox(a,b){$("#planet-info-container").show("fast"),a?$("#planet-info-name").text(a):$("#planet-info-name").text("Nameless"),$("#planet-info-owner").text("By "+b)}function menusOnDeletePlanetSystemView(){$("#edit-planet-tabs").hide(),$("#accordion-container").hide(),$("#planet-info-container").hide(),$("#jump-planet-moon-container").css({right:"120px"}),$("#jump-planet-moon-container").hide(),$("#add-planet-button").show()}function menusOnDeselect(){$("#edit-planet-tabs").hide(),$("#accordion-container").hide(),$("#jump-planet-moon-container").css({right:"120px"}),$("#planet-info-container").hide(),$("#jump-planet-button").hide(),$("#planet-info-container").hide(),jumpPlanetOk||jumpMoonOk?$("#build-planet-button").show():($("#edit-planet-button").hide(),$("#add-planet-button").show())}function buttonsOnAddMoon(){$("#jump-moon-button").show()}function buttonsOnViewPlanet(){soundOn&&document.getElementById("multiaudio6").play(),$("#add-planet-button").hide(),$("#jump-planet-button").hide(),$("#planet-info-container").hide(),$("#build-planet-button").show(),$("#edit-planet-button").hide(),$("#edit-planet-tabs").hide(),$("#accordion-container").hide(),thereAreMoons&&$("#jump-moon-button").show()}function buttonsOnViewMoon(){soundOn&&document.getElementById("multiaudio6").play(),$("#add-planet-button").hide(),$("#jump-moon-button").hide(),$("#planet-info-container").hide(),$("#jump-planet-moon-container").css({right:"120px"}),$("#build-planet-button").show(),$("#edit-planet-button").hide(),$("#edit-planet-tabs").hide(),$("#accordion-container").hide()}function buttonsOnViewSystem(){soundOn&&document.getElementById("multiaudio7").play(),$("#build-planet-button").hide(),$("#add-planet-button").show(),$("#jump-planet-moon-container").css({right:"120px"}),$("#accordion-container").hide(),thereArePlanets&&activePlanet&&($("#jump-planet-button").show(),$("#edit-planet-button").show()),thereAreMoons&&$("#jump-moon-button").show()}function buttonsForLoggedInUser(){$("#add-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1.0"}),$("#edit-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1.0"}),$("#build-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1.0"})}function buttonsForNonLoggedInUser(){$("#add-planet-button").css({color:"rgb(60, 60, 60)",opacity:"0.7"}),$("#edit-planet-button").css({color:"rgb(60, 60, 60)",opacity:"0.7"}),$("#build-planet-button").css({color:"rgb(60, 60, 60)",opacity:"0.7"})}function createAccount(){user=new Parse.User,user.set("username",newUsername),user.set("password",newUserPassword),user.signUp(null,{success:function(a){username=newUsername,userPassword=newUserPassword,login(),$("#add-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1.0"}),buttonsForLoggedInUser(),unlockAchievement("8jrXPu4yYe",a.id)},error:function(a,b){alert("Error: "+b.code+" "+b.message)}})}function login(){Parse.User.logIn(username,userPassword,{success:function(a){user=a,menusOnLogin(),buttonsForLoggedInUser()},error:function(a,b){console.log("login failed: "+b)}})}function logout(){Parse.User.logOut(),user=null,menusOnLogout(),buttonsForNonLoggedInUser()}function saveNewPlanetToDB(){if(user&&dbFunctionality){var a=Parse.Object.extend("Planet"),b=new a;b.set("ownerName",username),b.set("ownerId",user.id),b.set("system",currentSystem),b.set("name",""),b.set("texture","earthmap.jpg"),b.set("radius",150),b.set("size",1),b.set("rotationSpeed",.001),b.set("meteorBelt",!1),b.save(null,{success:function(a){console.log("New object saved with objectId: "+a.id);var b=[activePlanet,a.id,user.id];planetIds.push(b),unlockAchievement("89Siy4hAXF",user.id)},error:function(a,b){console.log("Failed to create new object, with error: "+b.message)}})}else console.log("no user logged in, planet not stored in db")}function updatePlanetInDB(){if(user&&dbFunctionality){for(var a,b,c,d,e,f,g,h,i=0;i<planetIds.length;++i)planetIds[i][0]==activePlanet&&(a=planetIds[i][1],b=planetIds[i][2]);for(var i=0;i<planetOrbitRadiuses.length;i++)planetOrbitRadiuses[i][0]==activePlanet&&(c=planetOrbitRadiuses[i][1]);for(var i=0;i<planetSizes.length;i++)planetSizes[i][0]==activePlanet&&(d=planetSizes[i][1]);for(var i=0;i<planetSpeeds.length;i++)planetSpeeds[i][0]==activePlanet&&(e=planetSpeeds[i][1]);for(var i=0;i<planetTextureFiles.length;i++)planetTextureFiles[i][0]==activePlanet&&(f=planetTextureFiles[i][1]);for(var i=0;i<planetNames.length;i++)planetNames[i][0]==activePlanet&&(g=planetNames[i][1]);for(var i=0;i<planetMeteorbeltStates.length;i++)planetMeteorbeltStates[i][0]==activePlanet&&(h=planetMeteorbeltStates[i][1]);var j=Parse.Object.extend("Planet"),k=new j;k.id=a,k.set("name",g),k.set("texture",f),k.set("radius",c),k.set("size",d),k.set("rotationSpeed",e),k.set("meteorBelt",h),k.save(null,{success:function(a){console.log("Updated object (id "+a.id+")")},error:function(a,b){console.log("Failed to update object: "+b.message)}})}}function deletePlanetFromDB(){if(user&&dbFunctionality){for(var a,b=0;b<planetIds.length;++b)planetIds[b][0]==activePlanet&&(a=planetIds[b][1]);var c=Parse.Object.extend("Planet"),d=new c;d.id=a,d.destroy({success:function(a){console.log(user.getUsername()+"s planet was deleted from the db")},error:function(a,b){console.log("could not delete planet: "+b)}})}}function loadPlanetsFromDB(a){if(dbFunctionality){var b=Parse.Object.extend("Planet"),c=new Parse.Query(b);c.equalTo("system",a),c.find({success:function(a){incrementTexturesToLoad(a.length);for(var b=0;b<a.length;b++){var c=a[b];addPlanet(c.id,c.get("ownerId"),c.get("name"),c.get("texture"),c.get("radius"),c.get("size"),c.get("rotationSpeed"),c.get("meteorBelt"),!0)}deselect()},error:function(a){console.log("Error retrieving planets: "+a.code+" "+a.message)}})}}function unlockAchievement(a,b){var c=Parse.Object.extend("UserUnlockedAchievements"),d=new Parse.Query(c);d.equalTo("achId",a),d.equalTo("userId",b),d.find({success:function(c){if(c.length>0);else{var d,e,f,g=Parse.Object.extend("Achievement"),h=new Parse.Query(g);h.get(a,{success:function(c){d=c.get("title"),e=c.get("description"),f=c.get("points");var g=Parse.Object.extend("UserUnlockedAchievements"),h=new g;h.set("achId",a),h.set("userId",b),h.save(null,{success:function(a){displayUnlockedAchievement(d,e,f)},error:function(a,b){console.log("Failed to create new object UserUnlockedAchievements, with error: "+b.message)}})},error:function(a,b){console.log("failed to retrieve "+a+", "+b)}})}},error:function(a){console.log("Finding unlocked achievements Error: "+a.code+" "+a.message)}})}function addLight(a,b,c,d,e,f){var g=new THREE.PointLight(16777215,1.5,4500);g.color.setHSL(a,b,c),g.position.set(d,e,f),sunSphere.add(g);var h=new THREE.Color(16777215);h.setHSL(a,b,c+.5),lensFlare=new THREE.LensFlare(textureFlare0,6400,0,THREE.AdditiveBlending,h),lensFlare.add(textureFlare2,512,0,THREE.AdditiveBlending),lensFlare.add(textureFlare2,512,0,THREE.AdditiveBlending),lensFlare.add(textureFlare2,512,0,THREE.AdditiveBlending),lensFlare.add(textureFlare3,60,.6,THREE.AdditiveBlending),lensFlare.add(textureFlare3,70,.7,THREE.AdditiveBlending),lensFlare.add(textureFlare3,120,.9,THREE.AdditiveBlending),lensFlare.add(textureFlare3,70,1,THREE.AdditiveBlending),lensFlare.customUpdateCallback=lensFlareUpdateCallback,lensFlare.position.copy(g.position),sunSphere.add(lensFlare)}function addSun(){customSunMaterial=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("vertexShaderSun").textContent,fragmentShader:document.getElementById("fragmentShaderSun").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),sunGeometry=new THREE.SphereGeometry(19,54,54),sunSphere=new THREE.Mesh(sunGeometry,customSunMaterial),activePlanet=sunSphere,clickedObject=sunSphere,incrementTexturesToLoad(1);var a=THREE.ImageUtils.loadTexture("textures/explosion.png",null,incrementTextureCount());a.minFilter=THREE.LinearFilter,proceduralSunMaterial=new THREE.ShaderMaterial({uniforms:{tExplosion:{type:"t",value:a},time:{type:"f",value:0}},vertexShader:document.getElementById("vertexShaderProcedural").textContent,fragmentShader:document.getElementById("fragmentShaderProcedural").textContent,side:THREE.BackSide,transparent:!0}),proceduralSun=new THREE.Mesh(new THREE.IcosahedronGeometry(12,5),proceduralSunMaterial),sunSphere.add(proceduralSun),galaxyGroup=new THREE.Object3D,rotationGroup=new THREE.Object3D,galaxyGroup.add(sunSphere),rotationGroup.add(galaxyGroup),scene.add(rotationGroup),addLight(.55,.9,.5,0,.5,1),addLight(.08,.8,.5,1,-.5,0)}function turnOnLensFlare(a){a?proceduralSun.material.side=THREE.BackSide:proceduralSun.material.side=THREE.FrontSide,visibility(lensFlare,a)}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function addPlanet(a,b,c,d,e,f,g,h,i){soundOn&&!i&&document.getElementById("multiaudio1").play(),thereArePlanets=!0;for(var j=0;j<clickedShells.length;++j)clickedShells[j][0]==activePlanet&&(mesh=clickedShells[j][0],visibility(mesh.children[2],!1));for(var j=0;j<clickedMoonShells.length;++j)clickedMoonShells[j][0]==activeMoon&&(mesh=clickedMoonShells[j][0],visibility(mesh.children[2],!1));activeMoon=null,activePlanet=null;var k=new THREE.SphereGeometry(12.5,60,60),l=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShader2").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),m=new THREE.Mesh(k,l);m.receiveShadow=!1,m.castShadow=!1;var n=addOrbitPath(e);sunSphere.add(n);var o=new THREE.SphereGeometry(11,60,60),p=new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture("textures/"+d,null,incrementTextureCount())});activePlanet=new THREE.Mesh(o,p),activePlanet.material.map.minFilter=THREE.NearestFilter,activePlanet.receiveShadow=!0,activePlanet.castShadow=!0,activePlanet.add(m);var q=new THREE.Object3D;q.position.x=0,activeRotationSpeed=g,planetNeedsInitialShift=!0;var r=new THREE.SphereGeometry(12,60,60),s=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("torusVertexShader").textContent,fragmentShader:document.getElementById("torusFragmentShader").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0});s.side=THREE.BackSide,hoverShell=new THREE.Mesh(r,planetHoverMaterial),visibility(hoverShell,!1),activePlanet.add(hoverShell);var t=new THREE.SphereGeometry(15,60,60),u=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("torusVertexShader").textContent,fragmentShader:document.getElementById("torusFragmentShader").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0});if(u.side=THREE.BackSide,clickedShell=new THREE.Mesh(t,planetHoverMaterial),visibility(clickedShell,!1),activePlanet.add(clickedShell),q.add(activePlanet),clickableObjects.push(activePlanet),planetGroups.push(q),addMeteorbelt(),h)for(var j=0;j<meteorbelts.length;++j)meteorbelts[j][0]==activePlanet&&(mesh=meteorbelts[j][0],visibility(mesh.children[3],!0));for(var j=0;j<planetGroups.length;++j)planetGroups[j]==q&&sunSphere.add(planetGroups[j]);activePlanet.scale.x=f,activePlanet.scale.y=f,activePlanet.scale.z=f;var v;if(v=[activePlanet,c],planetNames.push(v),v=[activePlanet,activeRotationSpeed,0,0,0],planetSpeeds.push(v),v=[activePlanet],planets.push(v),v=[activePlanet,f],planetSizes.push(v),v=[activePlanet,d],planetTextureFiles.push(v),v=[activePlanet,n],planetPaths.push(v),v=[activePlanet,h],planetMeteorbeltStates.push(v),v=[activePlanet,hoverShell],hoverShells.push(v),v=[activePlanet,clickedShell],clickedShells.push(v),v=[activePlanet,e],planetOrbitRadiuses.push(v),v=[activePlanet,0],planetAmountObjects.push(v),i){var v=[activePlanet,a,b];planetIds.push(v)}var w=new THREE.Object3D;activePlanet.add(w);var x=new THREE.Object3D;activePlanet.add(x),i||saveNewPlanetToDB()}function addMeteorbelt(){var a=new THREE.Object3D;for(geometry=new THREE.Geometry,sprite1=THREE.ImageUtils.loadTexture("textures/sprites/meteor11.png"),sprite1.minFilter=THREE.LinearFilter,i=0;i<1e4;i++){var b=new THREE.Vector3;sunRadius=16,sunRadius=9*Math.random()+sunRadius;var c,d=2*(Math.random()-.5)*sunRadius;c=Math.random()<.5?Math.sqrt(sunRadius*sunRadius-d*d):-Math.sqrt(sunRadius*sunRadius-d*d);var e=0;b.x=d,b.y=c,b.z=e,geometry.vertices.push(b)}for(parameters=[[[0,0,0],sprite1,.05]],i=0;i<parameters.length;i++)color=parameters[i][0],sprite=parameters[i][1],size=parameters[i][2],materials2[i]=new THREE.PointCloudMaterial({size:size,map:sprite,blending:THREE.AdditiveBlending,depthTest:!0,transparent:!0}),particles=new THREE.PointCloud(geometry,materials2[i]),a.add(particles);visibility(a,!1),activePlanet.add(a);var f;f=[activePlanet,a],meteorbelts.push(f)}function addOrbitPath(a){var b=new THREE.TorusGeometry(a,.3,16,100),c=new THREE.Mesh(b,planetOrbitMaterial);return showOrbits||(c.visible=!1),c}function addMoonOrbitPath(a){var b=new THREE.TorusGeometry(a,.2,16,100),c=(new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("torusVertexShader").textContent,fragmentShader:document.getElementById("torusMoonFragmentShader").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),new THREE.Mesh(b,moonOrbitMaterial));return c}function updatePlanetTexture(a){activePlanet.material.map=THREE.ImageUtils.loadTexture("textures/"+a),activePlanet.material.map.minFilter=THREE.NearestFilter,activePlanet.material.needsUpdate=!0;for(var b=0;b<planetTextureFiles.length;++b)planetTextureFiles[b][0]==activePlanet&&(planetTextureFiles[b][1]=a)}function addMoon(){thereAreMoons=!0,soundOn&&document.getElementById("multiaudio8").play();for(var a=0;a<clickedMoonShells.length;++a)clickedMoonShells[a][0]==activeMoon&&(mesh=clickedMoonShells[a][0],visibility(mesh.children[2],!1));var b=new THREE.SphereGeometry(2,32,32),c=new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture("textures/moontexture.jpg")});activeMoon=new THREE.Mesh(b,c),activeMoon.receiveShadow=!0,activeMoon.castShadow=!0;var d=new THREE.Object3D;d.add(activeMoon);var e=addMoonOrbitPath(20);activeMoon.parent.add(e),activeMoon.position.x=0,activeRotationSpeed=.001,moonNeedsInitialShift=!0,clickableObjects.push(activeMoon),activePlanet.add(d),moonGroups.push(d);var f=new THREE.SphereGeometry(3,32,32),g=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShaderMoonAtmos").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),h=new THREE.Mesh(f,g);h.receiveShadow=!1,h.castShadow=!1,activeMoon.add(h);var i=new THREE.SphereGeometry(2.8,32,32),j=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("torusVertexShader").textContent,fragmentShader:document.getElementById("torusMoonFragmentShader").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0});j.side=THREE.BackSide,hoverMoonShell=new THREE.Mesh(i,moonHoverMaterial),visibility(hoverMoonShell,!1),activeMoon.add(hoverMoonShell);var k=new THREE.SphereGeometry(4,32,32),l=new THREE.ShaderMaterial({uniforms:{},vertexShader:document.getElementById("torusVertexShader").textContent,fragmentShader:document.getElementById("torusMoonFragmentShader").textContent,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0});l.side=THREE.BackSide,clickedMoonShell=new THREE.Mesh(k,moonHoverMaterial),visibility(clickedMoonShell,!1),activeMoon.add(clickedMoonShell);for(var a=0;a<planets.length;++a)planets[a][0]==activePlanet&&planets[a].push(activeMoon);tempArray=[activeMoon,activeRotationSpeed,0,0,0],moonSpeeds.push(tempArray),tempArray=[activeMoon,e],moonPaths.push(tempArray),tempArray=[activePlanet,activeMoon],planetObjects.push(tempArray),tempArray=[activeMoon,hoverMoonShell],hoverMoonShells.push(tempArray),tempArray=[activeMoon,clickedMoonShell],clickedMoonShells.push(tempArray),tempArray=[activePlanet,20],moonOrbitRadiuses.push(tempArray);var m=new THREE.Object3D;activeMoon.add(m);var n=new THREE.Object3D;activeMoon.add(n)}function removePlanet(){for(var a=0;a<planetSpeeds.length;++a)planetSpeeds[a][0]==activePlanet&&planetSpeeds.splice(a,1);for(var a=0;a<planetSizes.length;++a)planetSizes[a][0]==activePlanet&&planetSizes.splice(a,1);for(var a=0;a<hoverShells.length;++a)hoverShells[a][0]==activePlanet&&hoverShells.splice(a,1);for(var a=0;a<clickedShells.length;++a)clickedShells[a][0]==activePlanet&&clickedShells.splice(a,1);for(var a=0;a<planetOrbitRadiuses.length;++a)planetOrbitRadiuses[a][0]==activePlanet&&planetOrbitRadiuses.splice(a,1);for(var a=0;a<planetIds.length;++a)planetIds[a][0]==activePlanet&&planetIds.splice(a,1);for(var a=0;a<planetPaths.length;++a)planetPaths[a][0]==activePlanet&&(sunSphere.remove(planetPaths[a][1]),planetPaths.splice(a,1));for(var a=0;a<planetAmountObjects.length;++a)planetAmountObjects[a][0]==activePlanet&&(sunSphere.remove(planetAmountObjects[a][1]),planetAmountObjects.splice(a,1));for(var a=0;a<planets.length;++a)planets[a][0]==activePlanet&&planets.splice(a,1);for(var a=0;a<clickableObjects.length;++a)clickableObjects[a]==activePlanet&&clickableObjects.splice(a,1);for(var a=0;a<planetGroups.length;++a)planetGroups[a].children[0]==activePlanet&&(sunSphere.remove(planetGroups[a]),planetGroups[a].remove(activePlanet),activePlanet.material.dispose(),activePlanet.geometry.dispose());activePlanet=null}function removeAllPlanetsLocally(){for(var a=0;a<planets.length;++a){activePlanet=planets[a][0];for(var b=0;b<planetPaths.length;++b)planetPaths[b][0]==activePlanet&&(sunSphere.remove(planetPaths[b][1]),planetPaths.splice(b,1));for(var b=0;b<planetGroups.length;++b)planetGroups[b].children[0]==activePlanet&&(sunSphere.remove(planetGroups[b]),planetGroups[b].remove(activePlanet),activePlanet.material.dispose(),activePlanet.geometry.dispose())}planets=[],clickableObjects=[],planetSpeeds=[],moonSpeeds=[],planetPaths=[],moonPaths=[],planetObjects=[],moonObjects=[],hoverShells=[],hoverMoonShells=[],clickedShells=[],clickedMoonShells=[],planetSizes=[],meteorbelts=[],planetIds=[],planetTextureFiles=[],planetNames=[],planetMeteorbeltStates=[],planetOrbitRadiuses=[]}function buildHouse(){jumpInAction||(buildHouseOk?buildHouseOk=!1:buildHouseOk=!0)}function playMusic(a){if(""!=currentSong)if(music.ended)currentSong="";else{if(currentSong==a)return music.pause(),void(currentSong="");music.pause()}music=new Audio("music/"+a),music.play(),currentSong=a}function onDocumentTouchStart(a){a.preventDefault(),a.clientX=a.touches[0].clientX,a.clientY=a.touches[0].clientY,onDocumentMouseDown(a)}function onDocumentMouseDown(a){if(selectPlanetsOk||buildHouseOk){if(a.preventDefault(),mouse.x=a.clientX/renderer.domElement.width*2-1,mouse.y=2*-(a.clientY/renderer.domElement.height)+1,raycaster.setFromCamera(mouse,camera),intersects=raycaster.intersectObjects(clickableObjects),selectPlanetsOk){for(var b=0;b<clickedShells.length;++b)clickedShells[b][0]==activePlanet&&(mesh=clickedShells[b][0],visibility(mesh.children[2],!1));for(var b=0;b<clickedMoonShells.length;++b)clickedMoonShells[b][0]==activeMoon&&(mesh=clickedMoonShells[b][0],visibility(mesh.children[2],!1))}if(intersects.length>0&&!jumpInAction&&selectPlanetsOk){var c=intersects[0].object;jumpPlanetOk&&(previousObject=activePlanet),jumpMoonOk&&(previousObject=activeMoon);for(var b=0;b<planetGroups.length;++b)c.parent==planetGroups[b]&&(activePlanet=c,planetIsSelected=!0,jumpMoonOk||(activeMoon=null)),!jumpPlanetOk&&soundOn&&document.getElementById("multiaudio4").play();for(var b=0;b<moonGroups.length;++b)c.parent==moonGroups[b]&&(activeMoon=c,activePlanet=activeMoon.parent.parent,planetIsSelected=!0,!jumpMoonOk&&soundOn&&document.getElementById("multiaudio4").play());if(!planetIsSelected||jumpPlanetOk||jumpMoonOk||showButtonsForActivePlanet(),dbFunctionality){for(var d,b=0;b<planetNames.length;++b)planetNames[b][0]==activePlanet&&(d=planetNames[b][1]);for(var e,b=0;b<planetIds.length;++b)activePlanet==planetIds[b][0]&&(e=planetIds[b][1]);var f,g=Parse.Object.extend("Planet"),h=new Parse.Query(g);if(h.get(e,{success:function(a){f=a.get("ownerName"),showPlanetInfoBox(d,f)},error:function(a,b){console.log("failed to retrieve "+a+", "+b)}}),editAccess=!1,user)for(var b=0;b<planetIds.length;++b)activePlanet==planetIds[b][0]&&user.id==planetIds[b][2]&&(editAccess=!0);editAccess?($("#edit-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1"}),$("#build-planet-button").css({color:"rgb(245, 229, 215)",opacity:"1"})):($("#edit-planet-button").css({color:"rgb(60, 60, 60)",opacity:"0.7"}),$("#build-planet-button").css({color:"rgb(60, 60, 60)",opacity:"0.7"}))}}if(intersects.length>0&&buildHouseOk&&!selectPlanetsOk){createHouse(intersects[0].object.worldToLocal(intersects[0].point));for(var b=0;b<planetAmountObjects.length;b++)planetAmountObjects[b][0]==activePlanet&&(++planetAmountObjects[b][1],10==planetAmountObjects[b][1]&&unlockAchievement("uqFdEiD5Ob",user.id));buildHouseOk=!1}3==a.which&&deselect()}}function deselect(){menusOnDeselect(),selectPlanetsOk=!0,planetIsSelected=!1;for(var a=0;a<clickedShells.length;++a)clickedShells[a][0]==activePlanet&&(mesh=clickedShells[a][0],visibility(mesh.children[2],!1));for(var a=0;a<clickedMoonShells.length;++a)clickedMoonShells[a][0]==activeMoon&&(mesh=clickedMoonShells[a][0],visibility(mesh.children[2],!1));activePlanet=null,activeMoon=null}function onMouseMove(a){if(selectPlanetsOk||buildHouseOk){a.preventDefault(),mouse.x=a.clientX/renderer.domElement.width*2-1,mouse.y=2*-(a.clientY/renderer.domElement.height)+1,raycaster.setFromCamera(mouse,camera),intersects=raycaster.intersectObjects(clickableObjects);for(var b=0;b<hoverShells.length;++b)hoverShells[b][0]==hoveredPlanet&&(mesh=hoverShells[b][0],visibility(mesh.children[1],!1));for(var b=0;b<hoverMoonShells.length;++b)hoverMoonShells[b][0]==hoveredMoon&&(mesh=hoverMoonShells[b][0],visibility(mesh.children[1],!1));if(intersects.length>0){for(var c=-1,d=intersects[0].object,b=0;b<planetGroups.length;++b)d.parent==planetGroups[b]&&(hoveredPlanet=d,c=1);for(var b=0;b<moonGroups.length;++b)d.parent==moonGroups[b]&&(hoveredMoon=d,c=0);if(c)for(var b=0;b<hoverShells.length;++b)hoverShells[b][0]==hoveredPlanet&&(mesh=hoverShells[b][0],visibility(mesh.children[1],!0));else for(var b=0;b<hoverMoonShells.length;++b)hoverMoonShells[b][0]==hoveredMoon&&(mesh=hoverMoonShells[b][0],visibility(mesh.children[1],!0))}if(buildHouseOk){if(jumpPlanetOk){for(b=activePlanet.children[5].children.length;b>=0;b--)activePlanet.children[5].remove(activePlanet.children[5].children[b]);intersects.length>0&&intersects[0].object==activePlanet&&showHouse(intersects[0].object.worldToLocal(intersects[0].point))}if(jumpMoonOk){for(b=activeMoon.children[3].children.length;b>=0;b--)activeMoon.children[3].remove(activeMoon.children[3].children[b]);intersects.length>0&&intersects[0].object==activeMoon&&showHouse(intersects[0].object.worldToLocal(intersects[0].point))}}}}function wheel(a){var b=0;a||(a=window.event),a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),b&&handle(b),a.preventDefault&&a.preventDefault(),console.log("hej"),a.returnValue=!1}function lensFlareUpdateCallback(a){var b,c,d=this.lensFlares.length,e=2*-this.positionScreen.x,f=2*-this.positionScreen.y,g=camera.position.length();for(b=0;d>b;b++)c=this.lensFlares[b],c.x=this.positionScreen.x+e*c.distance,c.y=this.positionScreen.y+f*c.distance,c.wantedRotation=c.x*Math.PI*.25,c.rotation+=.25*(c.wantedRotation-c.rotation),c.scale=1/g*200}function visibility(a,b){a.traverse(function(a){a.visible=b})}function loadStars(){for(geometry=new THREE.Geometry,incrementTexturesToLoad(5),sprite1=THREE.ImageUtils.loadTexture("textures/sprites/star12.png",null,incrementTextureCount()),sprite2=THREE.ImageUtils.loadTexture("textures/sprites/star12.png",null,incrementTextureCount()),sprite3=THREE.ImageUtils.loadTexture("textures/sprites/star13.png",null,incrementTextureCount()),sprite4=THREE.ImageUtils.loadTexture("textures/sprites/star14.png",null,incrementTextureCount()),sprite5=THREE.ImageUtils.loadTexture("textures/sprites/star15.png",null,incrementTextureCount()),i=0;i<2e4;i++){var a=new THREE.Vector3;a.x=2e4*Math.random()-1e4,a.y=2e4*Math.random()-1e4,a.z=2e4*Math.random()-1e4,(Math.abs(a.x)>1e3||Math.abs(a.y)>1e3||Math.abs(a.z)>1e3)&&geometry.vertices.push(a)}parameters=[[[0,0,0],sprite1,90],[[0,0,0],sprite2,80],[[0,0,0],sprite3,100],[[0,0,0],sprite4,70],[[0,0,0],sprite5,60]];var b=[];for(i=0;i<5;++i)sprite=parameters[i][1],size=parameters[i][2],materials[i]=new THREE.PointCloudMaterial({size:size,map:sprite,blending:THREE.AdditiveBlending,depthTest:!0,transparent:!0,alphaTest:.015,opacity:.85,fog:.8}),b=new THREE.PointCloud(geometry,materials[i]),b.rotation.x=6*Math.random(),b.rotation.y=6*Math.random(),b.rotation.z=6*Math.random(),stars.push(b)}function keyDown(a){var b;if(window.event?b=a.keyCode:a.which&&(b=a.which),"W"==String.fromCharCode(b)&&a.shiftKey&&(showOrbits?showOrbits=!1:showOrbits=!0,showOrbitsFunction()),"E"==String.fromCharCode(b)&&a.shiftKey&&!jumpPlanetOk&&!jumpMoonOk){$("#edit-planet-tabs").hide(),$("#accordion-container").hide(),$("#jump-planet-moon-container").css({right:"120px"}),jumpPlanetOk||jumpMoonOk?$("#build-planet-button").show():($("#edit-planet-button").hide(),$("#add-planet-button").show()),selectPlanetsOk=!0,planetIsSelected=!1,$("#jump-planet-button").hide(),$("#planet-info-container").hide();for(var c=0;c<clickedShells.length;++c)clickedShells[c][0]==activePlanet&&(mesh=clickedShells[c][0],visibility(mesh.children[2],!1));for(var c=0;c<clickedMoonShells.length;++c)clickedMoonShells[c][0]==activeMoon&&(mesh=clickedMoonShells[c][0],visibility(mesh.children[2],!1));activePlanet=null,activeMoon=null}"Q"==String.fromCharCode(b)&&a.shiftKey&&(showMenu?($("#all-panels").hide(),showMenu=!1):($("#all-panels").show(),showMenu=!0)),32==a.keyCode&&a.shiftKey&&$("#jump-system-button").click()}function showOrbitsFunction(){for(var a=0;a<planetPaths.length;++a)planetPaths[a][1].visible=showOrbits;for(var a=0;a<moonPaths.length;++a)moonPaths[a][1].visible=showOrbits}function displayUnlockedAchievement(a,b,c){console.log("unlocked achievement: "+a),console.log("desc: "+b+" | "+c+" points"),$(".achievement-text").text(a),$(".achievement-points").text(c+" pts"),setTimeout(function(){$(".achievement-box").animate({left:20,opacity:"show"},500)},1e3),setTimeout(function(){$(".achievement-text").fadeOut("slow",function(){$(".achievement-text").text(b),$(".achievement-text").fadeIn()}),setTimeout(function(){$(".achievement-box").fadeOut()},5e3)},4e3)}function changeSolarSystem(a){deselect(),removeAllPlanetsLocally(),$("#all-panels").hide(),$("#dim-screen").addClass("transparent-50"),$("#dim-screen").show(),showLoadingSpinner(),resetLoadingStats(),loadingOtherSystem=!0,loadPlanetsFromDB(a),currentSystem=a}function incrementTexturesToLoad(a){-1==texturesToLoad?texturesToLoad=a:texturesToLoad+=a}function incrementModelsToLoad(a){-1==modelsToLoad?modelsToLoad=a:modelsToLoad+=a}function incrementTextureCount(){++loadedTextures}function incrementModelCount(){++loadedModels}function resetLoadingStats(){texturesToLoad=-1,loadedTextures=0,modelsToLoad=-1,loadedModels=0,frameCounter=0,$("#loading-text").text("0% loaded")}function showLoadingSpinner(){var a={lines:17,length:1,width:6,radius:45,scale:1.25,corners:1,color:"#fff",opacity:.15,rotate:0,direction:1,speed:1.5,trail:74,fps:20,zIndex:2e9,className:"spinner",top:"51%",left:"50%",shadow:!0,hwaccel:!0,position:"absolute"},b=document.getElementById("dim-screen");spinner=new Spinner(a).spin(b)}function checkIfDoneLoading(a){a?($("#loading-text").text(calculateLoadedPercent(!1)+"% loaded"),(loadedTextures==texturesToLoad&&loadedModels>=modelsToLoad-1&&frameCounter>=60||frameCounter>=200)&&(camera.position.z=0,spinner.stop(),$("#dim-screen").fadeOut(),appLoaded=!0)):($("#loading-text").text(calculateLoadedPercent(!0)+"% loaded"),loadedTextures==texturesToLoad&&(spinner.stop(),$("#dim-screen").fadeOut(),$("#all-panels").fadeIn(),loadingOtherSystem=!1))}function calculateLoadedPercent(a){var b=0,c=0,d=0;return a?(c=loadedTextures,d=texturesToLoad,b=c/d*100):(c=loadedTextures+loadedModels,d=texturesToLoad+modelsToLoad,b=c/d*100),Math.round(b)}function build(a){buildHouseOk=!0,building=a}function showHouse(a){jumpPlanetOk?(1==building&&(visibility(volcano,!0),volcano.position.copy({x:a.x*activePlanetSize,y:a.y*activePlanetSize,z:a.z*activePlanetSize}),volcano.lookAt({x:0,y:0,z:0})),2==building&&(windmill.traverse(function(a){a.visible=!0}),windmill.position.copy({x:a.x*activePlanetSize,y:a.y*activePlanetSize,z:a.z*activePlanetSize}),windmill.lookAt({x:0,y:0,z:0})),3==building&&(bridge.traverse(function(a){a.visible=!0}),bridge.position.copy({x:a.x*activePlanetSize,y:a.y*activePlanetSize,z:a.z*activePlanetSize}),bridge.lookAt({x:0,y:0,z:0})),4==building&&(goose.traverse(function(a){a.visible=!0}),goose.position.copy({x:a.x*activePlanetSize,y:a.y*activePlanetSize,z:a.z*activePlanetSize}),goose.lookAt({x:0,y:0,z:0}))):jumpMoonOk&&loader.load("obj/volcano.js",function(b){visibility(volcano,!0),volcano.position.copy(a),volcano.lookAt({x:0,y:0,z:0})})}function createHouse(a){console.log("create house planet"),soundOn&&document.getElementById("multiaudio3").play(),jumpPlanetOk?(1==building&&loader.load("obj/volcano.js",function(b){object=new THREE.Mesh(b,new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("obj/volcano.png")})),activePlanet.children[4].add(object),activePlanet.children[5].remove(activePlanet.children[5].children[0]),object.position.copy(a);for(var c=0;c<planetSizes.length;c++)planetSizes[c][0]==activePlanet&&(buildingSize=.5/planetSizes[c][1]);object.scale.set(buildingSize,buildingSize,buildingSize),object.lookAt({x:0,y:0,z:0}),object.receiveShadow=!0,object.castShadow=!0,meshes.push(object)}),2==building&&loader2.load("obj/windmill.obj","obj/windmill.mtl",function(b){activePlanet.children[4].add(b),activePlanet.children[5].remove(activePlanet.children[5].children[0]),
b.position.copy(a);for(var c=0;c<planetSizes.length;c++)planetSizes[c][0]==activePlanet&&(buildingSize=.2/planetSizes[c][1]);b.scale.set(buildingSize,buildingSize,buildingSize),b.lookAt({x:0,y:0,z:0}),meshes.push(b)},onProgress,onError),3==building&&loader2.load("obj/bridge.obj","obj/bridge.mtl",function(b){activePlanet.children[4].add(b),activePlanet.children[5].remove(activePlanet.children[5].children[0]),b.position.copy(a);for(var c=0;c<planetSizes.length;c++)planetSizes[c][0]==activePlanet&&(buildingSize=.7/planetSizes[c][1]);b.scale.set(buildingSize,buildingSize,buildingSize),b.lookAt({x:0,y:0,z:0}),meshes.push(b)},onProgress,onError),4==building&&loader2.load("obj/goose.obj","obj/goose.mtl",function(b){activePlanet.children[4].add(b),activePlanet.children[5].remove(activePlanet.children[5].children[0]),b.position.copy(a);for(var c=0;c<planetSizes.length;c++)planetSizes[c][0]==activePlanet&&(buildingSize=.7/planetSizes[c][1]);b.scale.set(buildingSize,buildingSize,buildingSize),b.lookAt({x:0,y:0,z:0}),meshes.push(b)},onProgress,onError)):jumpMoonOk&&(console.log("create house moon"),loader.load("obj/volcano.js",function(b){object=new THREE.Mesh(b,new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("obj/volcano.png")})),activeMoon.children[2].add(object),activeMoon.children[3].remove(activeMoon.children[3].children[0]),object.position.copy(a),object.scale.set(.5,.5,.5),object.lookAt({x:0,y:0,z:0}),object.receiveShadow=!0,object.castShadow=!0,meshes.push(object)})),visibility(volcano,!1),windmill.traverse(function(a){a.visible=!1}),bridge.traverse(function(a){a.visible=!1}),goose.traverse(function(a){a.visible=!1})}function planetBools(){jumpMoonOk?smallJump=!0:smallJump=!1,jumpInAction||activePlanet&&(jumpPlanetOk=!0,jumpMoonOk=!1,jumpSolarOk=!1)}function moonBools(){jumpPlanetOk?smallJump=!0:smallJump=!1,jumpInAction||activeMoon&&(jumpPlanetOk=!1,jumpMoonOk=!0,jumpSolarOk=!1)}function solarBools(){jumpSolarOk&&(resetSolarView=!0),jumpInAction||(jumpPlanetOk=!1,jumpMoonOk=!1,jumpSolarOk=!0)}function planetJump(){if(activePlanet!=previousObject){if(0==timer){timer=Math.PI,jumpInAction=!0,posx=galaxyGroup.position.x,posz=galaxyGroup.position.y,roty=galaxyGroup.rotation.z+rotationGroup.rotation.z,cameraPosX=camera.position.x,cameraPosY=camera.position.y,cameraPosZ=camera.position.z,controlsRotSpeed=controls.rotateSpeed;for(var a=0;a<planetOrbitRadiuses.length;++a)planetOrbitRadiuses[a][0]==activePlanet&&(zoomLevel=activePlanet.scale.x*planetZoom/(planetOrbitRadiuses[a][1]/60));planetOrbitMaterial.transparent=!0,showOrbits&&showOrbitsFunction()}if(galaxyGroup.position.x=posx*(1-Math.cos(timer))/2-activePlanet.position.x*(1+Math.cos(timer))/2,galaxyGroup.position.y=posz*(1-Math.cos(timer))/2-activePlanet.position.y*(1+Math.cos(timer))/2,rotationGroup.rotation.z=roty*(1-Math.cos(timer))/2-activePlanet.rotation.z*(1+Math.cos(timer))/2,camera.position.x=cameraPosX*(1+Math.cos(Math.PI-timer))/2-activePlanet.position.x*(1+Math.cos(timer))/2*zoomLevel,camera.position.y=cameraPosY*(1+Math.cos(Math.PI-timer))/2-activePlanet.position.y*(1+Math.cos(timer))/2*zoomLevel,camera.position.z=cameraPosZ*(1+Math.cos(Math.PI-timer))/2-activePlanet.position.z*(1+Math.cos(timer))/2*zoomLevel,smallJump?moonHoverMaterial.opacity=Math.cos(timer/2)*hoverOpacity:(planetOrbitMaterial.opacity=Math.cos(Math.PI/2-timer/2),planetHoverMaterial.opacity=Math.cos(Math.PI/2-timer/2)*hoverOpacity,moonOrbitMaterial.opacity=Math.cos(Math.PI/2-timer/2)*hoverOpacity),controls.rotateSpeed=0,timer-=.02,timer<0){timer=0,jumpInAction=!1,previousObject=activePlanet;for(var a=0;a<clickableObjects.length;a++)Math.abs(clickableObjects[a].rotation.z)>2*Math.PI&&(clickableObjects[a].rotation.z=clickableObjects[a].rotation.z-2*Math.PI);showOrbits=!1,showOrbitsFunction(),controls.rotateSpeed=controlsRotSpeed}}else{galaxyGroup.position.x=-activePlanet.position.x,galaxyGroup.position.y=-activePlanet.position.y,rotationGroup.rotation.z=-activePlanet.rotation.z;for(var a=0;a<clickableObjects.length;a++)Math.abs(clickableObjects[a].rotation.z)>2*Math.PI&&(clickableObjects[a].rotation.z=0)}}function moonJump(){if(activeMoon!=previousObject){if(0==timer){for(timer=Math.PI,jumpInAction=!0,posx=galaxyGroup.position.x,posz=galaxyGroup.position.y,roty=galaxyGroup.rotation.z+rotationGroup.rotation.z,cameraPosX=camera.position.x,cameraPosY=camera.position.y,cameraPosZ=camera.position.z,controlsRotSpeed=controls.rotateSpeed,b=0;b<planetOrbitRadiuses.length;b++)if(planetOrbitRadiuses[b][0]==activeMoon.parent.parent)var a=1/(planetOrbitRadiuses[b][1]/50);zoomLevel=activeMoon.scale.x*moonZoom*a,planetOrbitMaterial.transparent=!0,showOrbits&&showOrbitsFunction()}if(moonPosX=activeMoon.position.x+activePlanet.position.x,moonPosY=activeMoon.position.y+activePlanet.position.y,galaxyGroup.position.x=posx*(1-Math.cos(timer))/2-moonPosX*(1+Math.cos(timer))/2,galaxyGroup.position.y=posz*(1-Math.cos(timer))/2-moonPosY*(1+Math.cos(timer))/2,rotationGroup.rotation.z=roty*(1-Math.cos(timer))/2-activeMoon.rotation.z*(1+Math.cos(timer))/2,camera.position.x=cameraPosX*(1+Math.cos(Math.PI-timer))/2-moonPosX*(1+Math.cos(timer))/2*zoomLevel,camera.position.y=cameraPosY*(1+Math.cos(Math.PI-timer))/2-moonPosY*(1+Math.cos(timer))/2*zoomLevel,camera.position.z=cameraPosZ*(1+Math.cos(Math.PI-timer))/2-(activeMoon.position.z+activePlanet.position.z)*(1+Math.cos(timer))/2*zoomLevel,smallJump||(planetOrbitMaterial.opacity=Math.cos(Math.PI/2-timer/2),planetHoverMaterial.opacity=Math.cos(Math.PI/2-timer/2)*hoverOpacity,moonOrbitMaterial.opacity=Math.cos(Math.PI/2-timer/2)*hoverOpacity),moonHoverMaterial.opacity=Math.cos(Math.PI/2-timer/2)*hoverOpacity,controls.rotateSpeed=0,timer-=.02,timer<0){timer=0,jumpInAction=!1,previousObject=activeMoon;for(var b=0;b<clickableObjects.length;b++)Math.abs(clickableObjects[b].rotation.z)>2*Math.PI&&(clickableObjects[b].rotation.z=clickableObjects[b].rotation.z-2*Math.PI);showOrbits=!1,showOrbitsFunction(),controls.rotateSpeed=controlsRotSpeed}}else{moonPosX=activeMoon.position.x+activePlanet.position.x,moonPosY=activeMoon.position.y+activePlanet.position.y,galaxyGroup.position.x=-moonPosX,galaxyGroup.position.y=-moonPosY,rotationGroup.rotation.z=-activeMoon.rotation.z;for(var b=0;b<clickableObjects.length;b++)Math.abs(clickableObjects[b].rotation.z)>2*Math.PI&&(clickableObjects[b].rotation.z=0)}}function jumpToSun(){if(sunSphere!=previousObject||resetSolarView){for(0==timer&&(timer=Math.PI,jumpInAction=!0,posx=galaxyGroup.position.x,posz=galaxyGroup.position.y,roty=galaxyGroup.rotation.z+rotationGroup.rotation.z,cameraPosX=camera.position.x,cameraPosY=camera.position.y,cameraPosZ=camera.position.z,controlsRotSpeed=controls.rotateSpeed,showOrbits=!0,showOrbitsFunction()),maxRadius=0,a=0;a<planetOrbitRadiuses.length;a++)planetOrbitRadiuses[a][1]>maxRadius&&(maxRadius=planetOrbitRadiuses[a][1]);if(zoomLevel=galaxyZoom+maxRadius*maxRadius*.02+maxRadius*Math.sin(maxRadius/300*Math.PI),galaxyGroup.position.x=posx*(1-Math.cos(timer))/2-sunSphere.position.x*(1+Math.cos(timer))/2,galaxyGroup.position.y=posz*(1-Math.cos(timer))/2-sunSphere.position.y*(1+Math.cos(timer))/2,camera.position.x=cameraPosX*(1+Math.cos(Math.PI-timer))/2,camera.position.y=cameraPosY*(1+Math.cos(Math.PI-timer))/2,camera.position.z=cameraPosZ*(1+Math.cos(Math.PI-timer))/2-zoomLevel*(1+Math.cos(timer))/2,resetSolarView||(planetOrbitMaterial.opacity=Math.cos(timer/2),planetHoverMaterial.opacity=Math.cos(timer/2)*hoverOpacity,moonOrbitMaterial.opacity=Math.cos(timer/2)*hoverOpacity),controls.rotateSpeed=0,timer-=.02,timer<0){timer=0,jumpInAction=!1,resetSolarView=!1,previousObject=sunSphere;for(var a=0;a<clickableObjects.length;a++)Math.abs(clickableObjects[a].rotation.z)>2*Math.PI&&(clickableObjects[a].rotation.z=clickableObjects[a].rotation.z-2*Math.PI);planetOrbitMaterial.transparent=!1,controls.rotateSpeed=controlsRotSpeed}}else{galaxyGroup.position.x=0,galaxyGroup.position.y=0;for(var a=0;a<clickableObjects.length;a++)Math.abs(clickableObjects[a].rotation.z)>2*Math.PI&&(clickableObjects[a].rotation.z=0)}}THREE.MTLLoader=function(a,b,c){this.baseUrl=a,this.options=b,this.crossOrigin=c},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader;f.setCrossOrigin(this.crossOrigin),f.load(a,function(a){b(e.parse(a))},c,d)},parse:function(a){for(var b=a.split("\n"),c={},d=/\s+/,e={},f=0;f<b.length;f++){var g=b[f];if(g=g.trim(),0!==g.length&&"#"!==g.charAt(0)){var h=g.indexOf(" "),i=h>=0?g.substring(0,h):g;i=i.toLowerCase();var j=h>=0?g.substring(h+1):"";if(j=j.trim(),"newmtl"===i)c={name:j},e[j]=c;else if(c)if("ka"===i||"kd"===i||"ks"===i){var k=j.split(d,3);c[i]=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])]}else c[i]=j}}var l=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.options);return l.crossOrigin=this.crossOrigin,l.setMaterials(e),l}},THREE.MTLLoader.MaterialCreator=function(a,b){this.baseUrl=a,this.options=b,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={};for(var c in a){var d=a[c],e={};b[c]=e;for(var f in d){var g=!0,h=d[f],i=f.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[1]&&(g=!1);break;case"d":this.options&&this.options.invertTransparency&&(h=1-h)}g&&(e[i]=h)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(a){var b=this.materialsInfo[a],c={name:a,side:this.side};for(var d in b){var e=b[d];switch(d.toLowerCase()){case"kd":c.diffuse=(new THREE.Color).fromArray(e);break;case"ka":break;case"ks":c.specular=(new THREE.Color).fromArray(e);break;case"map_kd":c.map=this.loadTexture(this.baseUrl+e),c.map.wrapS=this.wrap,c.map.wrapT=this.wrap;break;case"ns":c.shininess=e;break;case"d":1>e&&(c.transparent=!0,c.opacity=e);break;case"map_bump":case"bump":if(c.bumpMap)break;c.bumpMap=this.loadTexture(this.baseUrl+e),c.bumpMap.wrapS=this.wrap,c.bumpMap.wrapT=this.wrap}}return c.diffuse&&(c.color=c.diffuse),this.materials[a]=new THREE.MeshPhongMaterial(c),this.materials[a]},loadTexture:function(a,b,c,d){var e,f=THREE.Loader.Handlers.get(a);return null!==f?e=f.load(a,c):(e=new THREE.Texture,f=new THREE.ImageLoader,f.crossOrigin=this.crossOrigin,f.load(a,function(a){e.image=THREE.MTLLoader.ensurePowerOfTwo_(a),e.needsUpdate=!0,c&&c(e)})),void 0!==b&&(e.mapping=b),e}},THREE.MTLLoader.ensurePowerOfTwo_=function(a){if(!THREE.Math.isPowerOfTwo(a.width)||!THREE.Math.isPowerOfTwo(a.height)){var b=document.createElement("canvas");b.width=THREE.MTLLoader.nextHighestPowerOfTwo_(a.width),b.height=THREE.MTLLoader.nextHighestPowerOfTwo_(a.height);var c=b.getContext("2d");return c.drawImage(a,0,0,a.width,a.height,0,0,b.width,b.height),b}return a},THREE.MTLLoader.nextHighestPowerOfTwo_=function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1},THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype),THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a){return String.fromCharCode(255&a,a>>8&255,a>>16&255,a>>24&255)}function e(a,b,c,d){for(var e=c*d*4,f=new Uint8Array(a,b,e),g=new Uint8Array(e),h=0,i=0,j=0;d>j;j++)for(var k=0;c>k;k++){var l=f[i];i++;var m=f[i];i++;var n=f[i];i++;var o=f[i];i++,g[h]=n,h++,g[h]=m,h++,g[h]=l,h++,g[h]=o,h++}return g}var f={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},g=542327876,h=131072,i=512,j=4,k=c("DXT1"),l=c("DXT3"),m=c("DXT5"),n=31,o=0,p=1,q=2,r=3,s=4,t=7,u=20,v=21,w=22,x=23,y=24,z=25,A=26,B=28,C=new Int32Array(a,0,n);if(C[o]!==g)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),f;if(!C[u]&j)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),f;var D,E=C[v],F=!1;switch(E){case k:D=8,f.format=THREE.RGB_S3TC_DXT1_Format;break;case l:D=16,f.format=THREE.RGBA_S3TC_DXT3_Format;break;case m:D=16,f.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==C[w]&&16711680&C[x]&&65280&C[y]&&255&C[z]&&4278190080&C[A]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",d(E)),f;F=!0,D=64,f.format=THREE.RGBAFormat}f.mipmapCount=1,C[q]&h&&b!==!1&&(f.mipmapCount=Math.max(1,C[t])),f.isCubemap=C[B]&i?!0:!1,f.width=C[s],f.height=C[r];for(var G=C[p]+4,H=f.width,I=f.height,J=f.isCubemap?6:1,K=0;J>K;K++){for(var L=0;L<f.mipmapCount;L++){if(F)var M=e(a,G,H,I),N=M.length;else var N=Math.max(4,H)/4*Math.max(4,I)/4*D,M=new Uint8Array(a,G,N);var O={data:M,width:H,height:I};f.mipmaps.push(O),G+=N,H=Math.max(.5*H,1),I=Math.max(.5*I,1)}H=f.width,I=f.height}return f},THREE.OBJMTLLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.OBJMTLLoader.prototype={constructor:THREE.OBJMTLLoader,load:function(a,b,c,d,e){var f=this,g=new THREE.MTLLoader(a.substr(0,a.lastIndexOf("/")+1));g.crossOrigin=f.crossOrigin,g.load(b,function(b){var g=b;g.preload();var h=new THREE.XHRLoader(f.manager);h.setCrossOrigin(f.crossOrigin),h.load(a,function(a){var b=f.parse(a);b.traverse(function(a){if(a instanceof THREE.Mesh&&a.material.name){var b=g.create(a.material.name);b&&(a.material=b)}}),c(b)},d,e)},d,e)},parse:function(a,b){function c(a,b,c){return new THREE.Vector3(a,b,c)}function d(a,b){return new THREE.Vector2(a,b)}function e(a,b,c,d){return new THREE.Face3(a,b,c,d)}function f(a,b){p.length>0&&(m.vertices=p,m.mergeVertices(),m.computeFaceNormals(),m.computeBoundingSphere(),l.add(o),m=new THREE.Geometry,o=new THREE.Mesh(m,n)),void 0!==a&&(o.name=a),void 0!==b&&(n=new THREE.MeshLambertMaterial,n.name=b,o.material=n)}function g(a,b,c,d){void 0===d?m.faces.push(e(parseInt(a)-(j+1),parseInt(b)-(j+1),parseInt(c)-(j+1))):m.faces.push(e(parseInt(a)-(j+1),parseInt(b)-(j+1),parseInt(c)-(j+1),[q[parseInt(d[0])-1].clone(),q[parseInt(d[1])-1].clone(),q[parseInt(d[2])-1].clone()]))}function h(a,b,c){m.faceVertexUvs[0].push([r[parseInt(a)-1].clone(),r[parseInt(b)-1].clone(),r[parseInt(c)-1].clone()])}function i(a,b,c){void 0===a[3]?(g(a[0],a[1],a[2],c),void 0!==b&&b.length>0&&h(b[0],b[1],b[2])):(void 0!==c&&c.length>0?(g(a[0],a[1],a[3],[c[0],c[1],c[3]]),g(a[1],a[2],a[3],[c[1],c[2],c[3]])):(g(a[0],a[1],a[3]),g(a[1],a[2],a[3])),void 0!==b&&b.length>0&&(h(b[0],b[1],b[3]),h(b[1],b[2],b[3])))}for(var j=0,k=new THREE.Group,l=k,m=new THREE.Geometry,n=new THREE.MeshLambertMaterial,o=new THREE.Mesh(m,n),p=[],q=[],r=[],s=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,t=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,u=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,v=/f( +\d+)( +\d+)( +\d+)( +\d+)?/,w=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/,x=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/,y=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/,z=a.split("\n"),A=0;A<z.length;A++){var B=z[A];B=B.trim();var C;if(0!==B.length&&"#"!==B.charAt(0))if(null!==(C=s.exec(B)))p.push(c(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3])));else if(null!==(C=t.exec(B)))q.push(c(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3])));else if(null!==(C=u.exec(B)))r.push(d(parseFloat(C[1]),parseFloat(C[2])));else if(null!==(C=v.exec(B)))i([C[1],C[2],C[3],C[4]]);else if(null!==(C=w.exec(B)))i([C[2],C[5],C[8],C[11]],[C[3],C[6],C[9],C[12]]);else if(null!==(C=x.exec(B)))i([C[2],C[6],C[10],C[14]],[C[3],C[7],C[11],C[15]],[C[4],C[8],C[12],C[16]]);else if(null!==(C=y.exec(B)))i([C[2],C[5],C[8],C[11]],[],[C[3],C[6],C[9],C[12]]);else if(/^o /.test(B))f(),j+=p.length,p=[],l=new THREE.Object3D,l.name=B.substring(2).trim(),k.add(l);else if(/^g /.test(B))f(B.substring(2).trim(),void 0);else if(/^usemtl /.test(B))f(void 0,B.substring(7).trim());else if(/^mtllib /.test(B)){if(b){var D=B.substring(7);D=D.trim(),b(D)}}else/^s /.test(B)||console.log("THREE.OBJMTLLoader: Unhandled line "+B)}return f(void 0,void 0),k}},THREE.EventDispatcher.prototype.apply(THREE.OBJMTLLoader.prototype),THREE.OBJLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader(e.manager);f.setCrossOrigin(this.crossOrigin),f.load(a,function(a){b(e.parse(a))},c,d)},parse:function(a){function b(a){var b=parseInt(a);return 3*(b>=0?b-1:b+m.length/3)}function c(a){var b=parseInt(a);return 3*(b>=0?b-1:b+n.length/3)}function d(a){var b=parseInt(a);return 2*(b>=0?b-1:b+o.length/2)}function e(a,b,c){j.vertices.push(m[a],m[a+1],m[a+2],m[b],m[b+1],m[b+2],m[c],m[c+1],m[c+2])}function f(a,b,c){j.normals.push(n[a],n[a+1],n[a+2],n[b],n[b+1],n[b+2],n[c],n[c+1],n[c+2])}function g(a,b,c){j.uvs.push(o[a],o[a+1],o[b],o[b+1],o[c],o[c+1])}function h(a,h,i,j,k,l,m,n,o,p,q,r){var s,t=b(a),u=b(h),v=b(i);void 0===j?e(t,u,v):(s=b(j),e(t,u,s),e(u,v,s)),void 0!==k&&(t=d(k),u=d(l),v=d(m),void 0===j?g(t,u,v):(s=d(n),g(t,u,s),g(u,v,s))),void 0!==o&&(t=c(o),u=c(p),v=c(q),void 0===j?f(t,u,v):(s=c(r),f(t,u,s),f(u,v,s)))}console.time("OBJLoader");var i,j,k,l=[];/^o /gm.test(a)===!1&&(j={vertices:[],normals:[],uvs:[]},k={name:""},i={name:"",geometry:j,material:k},l.push(i));for(var m=[],n=[],o=[],p=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,q=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,r=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,t=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,u=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,v=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,w=a.split("\n"),x=0;x<w.length;x++){var y=w[x];y=y.trim();var z;0!==y.length&&"#"!==y.charAt(0)&&(null!==(z=p.exec(y))?m.push(parseFloat(z[1]),parseFloat(z[2]),parseFloat(z[3])):null!==(z=q.exec(y))?n.push(parseFloat(z[1]),parseFloat(z[2]),parseFloat(z[3])):null!==(z=r.exec(y))?o.push(parseFloat(z[1]),parseFloat(z[2])):null!==(z=s.exec(y))?h(z[1],z[2],z[3],z[4]):null!==(z=t.exec(y))?h(z[2],z[5],z[8],z[11],z[3],z[6],z[9],z[12]):null!==(z=u.exec(y))?h(z[2],z[6],z[10],z[14],z[3],z[7],z[11],z[15],z[4],z[8],z[12],z[16]):null!==(z=v.exec(y))?h(z[2],z[5],z[8],z[11],void 0,void 0,void 0,void 0,z[3],z[6],z[9],z[12]):/^o /.test(y)?(j={vertices:[],normals:[],uvs:[]},k={name:""},i={name:y.substring(2).trim(),geometry:j,material:k},l.push(i)):/^g /.test(y)||(/^usemtl /.test(y)?k.name=y.substring(7).trim():/^mtllib /.test(y)||/^s /.test(y)))}for(var A=new THREE.Object3D,x=0,B=l.length;B>x;x++){i=l[x],j=i.geometry;var C=new THREE.BufferGeometry;C.addAttribute("position",new THREE.BufferAttribute(new Float32Array(j.vertices),3)),j.normals.length>0&&C.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(j.normals),3)),j.uvs.length>0&&C.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(j.uvs),2)),k=new THREE.MeshLambertMaterial,k.name=i.material.name;var D=new THREE.Mesh(C,k);D.name=i.name,A.add(D)}return console.timeEnd("OBJLoader"),A}},THREE.OrbitControls=function(a,b){function c(){return 2*Math.PI/60/60*o.autoRotateSpeed}function d(){return Math.pow(.95,o.zoomSpeed)}function e(a){if(o.enabled!==!1){if(a.preventDefault(),a.button===o.mouseButtons.ORBIT){if(o.noRotate===!0)return;I=H.ROTATE,q.set(a.clientX,a.clientY)}else if(a.button===o.mouseButtons.ZOOM){if(o.noZoom===!0)return;I=H.DOLLY,y.set(a.clientX,a.clientY)}else if(a.button===o.mouseButtons.PAN){if(o.noPan===!0)return;I=H.PAN,t.set(a.clientX,a.clientY)}I!==H.NONE&&(document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1),o.dispatchEvent(M))}}function f(a){if(o.enabled!==!1){a.preventDefault();var b=o.domElement===document?o.domElement.body:o.domElement;if(I===H.ROTATE){if(o.noRotate===!0)return;r.set(a.clientX,a.clientY),s.subVectors(r,q),o.rotateLeft(2*Math.PI*s.x/b.clientWidth*o.rotateSpeed),o.rotateUp(2*Math.PI*s.y/b.clientHeight*o.rotateSpeed),q.copy(r)}else if(I===H.DOLLY){if(o.noZoom===!0)return;z.set(a.clientX,a.clientY),A.subVectors(z,y),A.y>0?o.dollyIn():A.y<0&&o.dollyOut(),y.copy(z)}else if(I===H.PAN){if(o.noPan===!0)return;u.set(a.clientX,a.clientY),v.subVectors(u,t),o.pan(v.x,v.y),t.copy(u)}I!==H.NONE&&o.update()}}function g(){o.enabled!==!1&&(document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",g,!1),o.dispatchEvent(N),I=H.NONE)}function h(a){if(o.enabled!==!1&&o.noZoom!==!0&&I===H.NONE){a.preventDefault(),a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),b>0?o.dollyOut():0>b&&o.dollyIn(),o.update(),o.dispatchEvent(M),o.dispatchEvent(N)}}function i(a){if(o.enabled!==!1&&o.noKeys!==!0&&o.noPan!==!0)switch(a.keyCode){case o.keys.UP:o.pan(0,o.keyPanSpeed),o.update();break;case o.keys.BOTTOM:o.pan(0,-o.keyPanSpeed),o.update();break;case o.keys.LEFT:o.pan(o.keyPanSpeed,0),o.update();break;case o.keys.RIGHT:o.pan(-o.keyPanSpeed,0),o.update()}}function j(a){if(o.enabled!==!1){switch(a.touches.length){case 1:if(o.noRotate===!0)return;I=H.TOUCH_ROTATE,q.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(o.noZoom===!0)return;I=H.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);y.set(0,d);break;case 3:if(o.noPan===!0)return;I=H.TOUCH_PAN,t.set(a.touches[0].pageX,a.touches[0].pageY);break;default:I=H.NONE}I!==H.NONE&&o.dispatchEvent(M)}}function k(a){if(o.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=o.domElement===document?o.domElement.body:o.domElement;switch(a.touches.length){case 1:if(o.noRotate===!0)return;if(I!==H.TOUCH_ROTATE)return;r.set(a.touches[0].pageX,a.touches[0].pageY),s.subVectors(r,q),o.rotateLeft(2*Math.PI*s.x/b.clientWidth*o.rotateSpeed),o.rotateUp(2*Math.PI*s.y/b.clientHeight*o.rotateSpeed),q.copy(r),o.update();break;case 2:if(o.noZoom===!0)return;if(I!==H.TOUCH_DOLLY)return;var c=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY,e=Math.sqrt(c*c+d*d);z.set(0,e),A.subVectors(z,y),A.y>0?o.dollyOut():A.y<0&&o.dollyIn(),y.copy(z),o.update();break;case 3:if(o.noPan===!0)return;if(I!==H.TOUCH_PAN)return;u.set(a.touches[0].pageX,a.touches[0].pageY),v.subVectors(u,t),o.pan(v.x,v.y),t.copy(u),o.update();break;default:I=H.NONE}}}function l(){o.enabled!==!1&&(o.dispatchEvent(N),I=H.NONE)}this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var m,n,o=this,p=1e-6,q=new THREE.Vector2,r=new THREE.Vector2,s=new THREE.Vector2,t=new THREE.Vector2,u=new THREE.Vector2,v=new THREE.Vector2,w=new THREE.Vector3,x=new THREE.Vector3,y=new THREE.Vector2,z=new THREE.Vector2,A=new THREE.Vector2,B=0,C=0,D=1,E=new THREE.Vector3,F=new THREE.Vector3,G=new THREE.Quaternion,H={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},I=H.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var J=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),K=J.clone().inverse(),L={type:"change"},M={type:"start"},N={type:"end"};this.rotateLeft=function(a){void 0===a&&(a=c()),C-=a},this.rotateUp=function(a){void 0===a&&(a=c()),B-=a},this.panLeft=function(a){var b=this.object.matrix.elements;w.set(b[0],b[1],b[2]),w.multiplyScalar(-a),E.add(w)},this.panUp=function(a){var b=this.object.matrix.elements;w.set(b[4],b[5],b[6]),w.multiplyScalar(a),E.add(w)},this.pan=function(a,b){var c=o.domElement===document?o.domElement.body:o.domElement;if(o.object instanceof THREE.PerspectiveCamera){var d=o.object.position,e=d.clone().sub(o.target),f=e.length();f*=Math.tan(o.object.fov/2*Math.PI/180),o.panLeft(2*a*f/c.clientHeight),o.panUp(2*b*f/c.clientHeight)}else o.object instanceof THREE.OrthographicCamera?(o.panLeft(a*(o.object.right-o.object.left)/c.clientWidth),o.panUp(b*(o.object.top-o.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(a){void 0===a&&(a=d()),o.object instanceof THREE.PerspectiveCamera?D/=a:o.object instanceof THREE.OrthographicCamera?(o.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*a)),o.object.updateProjectionMatrix(),o.dispatchEvent(L)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(a){void 0===a&&(a=d()),o.object instanceof THREE.PerspectiveCamera?D*=a:o.object instanceof THREE.OrthographicCamera?(o.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/a)),o.object.updateProjectionMatrix(),o.dispatchEvent(L)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var a=this.object.position;x.copy(a).sub(this.target),x.applyQuaternion(J),m=Math.atan2(x.x,x.z),n=Math.atan2(Math.sqrt(x.x*x.x+x.z*x.z),x.y),this.autoRotate&&I===H.NONE&&this.rotateLeft(c()),m+=C,n+=B,m=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,m)),n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(p,Math.min(Math.PI-p,n));var b=x.length()*D;b=Math.max(this.minDistance,Math.min(this.maxDistance,b)),this.target.add(E),x.x=b*Math.sin(n)*Math.sin(m),x.y=b*Math.cos(n),x.z=b*Math.sin(n)*Math.cos(m),x.applyQuaternion(K),a.copy(this.target).add(x),this.object.lookAt(this.target),C=0,B=0,D=1,E.set(0,0,0),(F.distanceToSquared(this.object.position)>p||8*(1-G.dot(this.object.quaternion))>p)&&(this.dispatchEvent(L),F.copy(this.object.position),G.copy(this.object.quaternion))},this.reset=function(){I=H.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(L),this.update()},this.getPolarAngle=function(){return n},this.getAzimuthalAngle=function(){return m},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",j,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",k,!1),window.addEventListener("keydown",i,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.TrackballControls=function(a,b){function c(a){l.enabled!==!1&&(window.removeEventListener("keydown",c),q=p,p===m.NONE&&(a.keyCode!==l.keys[m.ROTATE]||l.noRotate?a.keyCode!==l.keys[m.ZOOM]||l.noZoom?a.keyCode!==l.keys[m.PAN]||l.noPan||(p=m.PAN):p=m.ZOOM:p=m.ROTATE))}function d(a){l.enabled!==!1&&(p=q,window.addEventListener("keydown",c,!1))}function e(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),p===m.NONE&&(p=a.button),p!==m.ROTATE||l.noRotate?p!==m.ZOOM||l.noZoom?p!==m.PAN||l.noPan||(y.copy(D(a.pageX,a.pageY)),z.copy(y)):(u.copy(D(a.pageX,a.pageY)),v.copy(u)):(s.copy(E(a.pageX,a.pageY)),t.copy(s)),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1),l.dispatchEvent(B))}function f(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),p!==m.ROTATE||l.noRotate?p!==m.ZOOM||l.noZoom?p!==m.PAN||l.noPan||z.copy(D(a.pageX,a.pageY)):v.copy(D(a.pageX,a.pageY)):t.copy(E(a.pageX,a.pageY)))}function g(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),p=m.NONE,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),l.dispatchEvent(C))}function h(a){if(l.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3),u.y+=.01*b,l.dispatchEvent(B),l.dispatchEvent(C)}}function i(a){if(l.enabled!==!1){switch(a.touches.length){case 1:p=m.TOUCH_ROTATE,s.copy(E(a.touches[0].pageX,a.touches[0].pageY)),t.copy(s);break;case 2:p=m.TOUCH_ZOOM_PAN;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;x=w=Math.sqrt(b*b+c*c);var d=(a.touches[0].pageX+a.touches[1].pageX)/2,e=(a.touches[0].pageY+a.touches[1].pageY)/2;y.copy(D(d,e)),z.copy(y);break;default:p=m.NONE}l.dispatchEvent(B)}}function j(a){if(l.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:t.copy(E(a.touches[0].pageX,a.touches[0].pageY));break;case 2:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;x=Math.sqrt(b*b+c*c);var d=(a.touches[0].pageX+a.touches[1].pageX)/2,e=(a.touches[0].pageY+a.touches[1].pageY)/2;z.copy(D(d,e));break;default:p=m.NONE}}function k(a){if(l.enabled!==!1){switch(a.touches.length){case 1:t.copy(E(a.touches[0].pageX,a.touches[0].pageY)),s.copy(t);break;case 2:w=x=0;var b=(a.touches[0].pageX+a.touches[1].pageX)/2,c=(a.touches[0].pageY+a.touches[1].pageY)/2;z.copy(D(b,c)),y.copy(z)}p=m.NONE,l.dispatchEvent(C)}}var l=this,m={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var n=1e-6,o=new THREE.Vector3,p=m.NONE,q=m.NONE,r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector2,v=new THREE.Vector2,w=0,x=0,y=new THREE.Vector2,z=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var A={type:"change"},B={type:"start"},C={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var a=this.domElement.getBoundingClientRect(),b=this.domElement.ownerDocument.documentElement;this.screen.left=a.left+window.pageXOffset-b.clientLeft,this.screen.top=a.top+window.pageYOffset-b.clientTop,this.screen.width=a.width,this.screen.height=a.height}},this.handleEvent=function(a){"function"==typeof this[a.type]&&this[a.type](a)};var D=function(){var a=new THREE.Vector2;return function(b,c){return a.set((b-l.screen.left)/l.screen.width,(c-l.screen.top)/l.screen.height),a}}(),E=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e){
c.set((d-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),(.5*l.screen.height+l.screen.top-e)/(.5*l.screen.height),0);var f=c.length();return l.noRoll?f<Math.SQRT1_2?c.z=Math.sqrt(1-f*f):c.z=.5/f:f>1?c.normalize():c.z=Math.sqrt(1-f*f),r.copy(l.object.position).sub(l.target),a.copy(l.object.up).setLength(c.y),a.add(b.copy(l.object.up).cross(r).setLength(c.x)),a.add(r.setLength(c.z)),a}}();this.rotateCamera=function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(){var c=Math.acos(s.dot(t)/s.length()/t.length());c&&(a.crossVectors(s,t).normalize(),c*=l.rotateSpeed,b.setFromAxisAngle(a,-c),r.applyQuaternion(b),l.object.up.applyQuaternion(b),t.applyQuaternion(b),l.staticMoving?s.copy(t):(b.setFromAxisAngle(a,c*(l.dynamicDampingFactor-1)),s.applyQuaternion(b)))}}(),this.zoomCamera=function(){if(p===m.TOUCH_ZOOM_PAN){var a=w/x;w=x,r.multiplyScalar(a)}else{var a=1+(v.y-u.y)*l.zoomSpeed;1!==a&&a>0&&(r.multiplyScalar(a),l.staticMoving?u.copy(v):u.y+=(v.y-u.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var a=new THREE.Vector2,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.copy(z).sub(y),a.lengthSq()&&(a.multiplyScalar(r.length()*l.panSpeed),c.copy(r).cross(l.object.up).setLength(a.x),c.add(b.copy(l.object.up).setLength(a.y)),l.object.position.add(c),l.target.add(c),l.staticMoving?y.copy(z):y.add(a.subVectors(z,y).multiplyScalar(l.dynamicDampingFactor)))}}(),this.checkDistances=function(){l.noZoom&&l.noPan||(r.lengthSq()>l.maxDistance*l.maxDistance&&l.object.position.addVectors(l.target,r.setLength(l.maxDistance)),r.lengthSq()<l.minDistance*l.minDistance&&l.object.position.addVectors(l.target,r.setLength(l.minDistance)))},this.update=function(){r.subVectors(l.object.position,l.target),l.noRotate||l.rotateCamera(),l.noZoom||l.zoomCamera(),l.noPan||l.panCamera(),l.object.position.addVectors(l.target,r),l.checkDistances(),l.object.lookAt(l.target),o.distanceToSquared(l.object.position)>n&&(l.dispatchEvent(A),o.copy(l.object.position))},this.reset=function(){p=m.NONE,q=m.NONE,l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.up.copy(l.up0),r.subVectors(l.object.position,l.target),l.object.lookAt(l.target),l.dispatchEvent(A),o.copy(l.object.position)},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",i,!1),this.domElement.addEventListener("touchend",k,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",c,!1),window.addEventListener("keyup",d,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls,jQuery(document).ready(function(){function a(){jQuery(".accordion .accordion-section-title").removeClass("active"),jQuery(".accordion .accordion-section-content").slideUp(300).removeClass("open")}jQuery(".accordion-section-title").click(function(b){var c=jQuery(this).attr("href");jQuery(b.target).is(".active")?a():(a(),jQuery(this).addClass("active"),jQuery(".accordion "+c).slideDown(300).addClass("open")),b.preventDefault()})});var modelNames=["volcano","windmill","bridge","goose"];loader=new THREE.JSONLoader,onProgress=function(a){a.lengthComputable},onError=function(a){console.log("build house error "+a)},THREE.Loader.Handlers.add(/\.dds$/i,new THREE.DDSLoader),loader2=new THREE.OBJMTLLoader,loader.load("obj/volcano.js",function(a){volcano=new THREE.Mesh(a,new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("obj/volcano.png")})),scene.add(volcano),volcano.scale.set(.5,.5,.5),volcano.receiveShadow=!0,volcano.castShadow=!0,volcano.transparent=!0,visibility(volcano,!1),incrementModelCount()}),loader2.load("obj/windmill.obj","obj/windmill.mtl",function(a){a.scale.set(.2,.2,.2),windmill.add(a),windmill.traverse(function(a){a.visible=!1}),incrementModelCount()},onProgress,onError),loader2.load("obj/bridge.obj","obj/bridge.mtl",function(a){a.scale.set(.7,.7,.7),bridge.add(a),bridge.traverse(function(a){a.visible=!1}),incrementModelCount()},onProgress,onError),loader2.load("obj/goose.obj","obj/goose.mtl",function(a){a.scale.set(.7,.7,.7),goose.add(a),goose.traverse(function(a){a.visible=!1}),incrementModelCount()},onProgress,onError);var cameraPosX,cameraPosY,cameraPosZ,controlsRotSpeed,zoomLevel,moonPosX,moonPosY,maxRadius,planetZoom=1.6,moonZoom=.5,galaxyZoom=650;jumpInAction=!1,smallJump=!1,$(document).ready(function(){$(function(){$(".planet_radius_slider").slider({min:130,max:900,value:150,step:1,slide:function(a,b){for(var c=0;c<planetPaths.length;++c)if(planetPaths[c][0]==activePlanet)if(planetPaths[c][1]){sunSphere.remove(planetPaths[c][1]);var d=addOrbitPath(b.value);sunSphere.add(d),planetPaths[c][1]=d,planetOrbitRadiuses[c][1]=b.value}else console.log("error: path not found")}})}),$(function(){$(".planet_size_slider").slider({min:1,max:4,value:1,step:.01,slide:function(a,b){activePlanet.scale.x=b.value,activePlanet.scale.y=b.value,activePlanet.scale.z=b.value;for(var c=0;c<planetSizes.length;++c)planetSizes[c][0]==activePlanet&&(planetSizes[c][1]=b.value)}})}),$(function(){$(".planet_rotation_slider").slider({min:.01,max:.25,value:.01,step:.01,change:function(a,b){for(var c=0;c<planetSpeeds.length;++c)planetSpeeds[c][0]==activePlanet&&planetSpeeds[c][1]!=b.value&&(0==planetSpeeds[c][4]?planetSpeeds[c][4]=planetSpeeds[c][1]*time:planetSpeeds[c][4]=planetSpeeds[c][4]+(time-planetSpeeds[c][3])*planetSpeeds[c][1],planetSpeeds[c][2]=planetSpeeds[c][1],planetSpeeds[c][1]=b.value,planetSpeeds[c][3]=time)}})}),$(".meteor-check").iCheck({checkboxClass:"icheckbox_square-yellow",increaseArea:"20%"}),$(".meteor-check").on("ifChecked",function(a){for(var b=0;b<meteorbelts.length;++b)meteorbelts[b][0]==activePlanet&&(mesh=meteorbelts[b][0],visibility(mesh.children[3],!0));for(var b=0;b<planetMeteorbeltStates.length;++b)activePlanet==planetMeteorbeltStates[b][0]&&(planetMeteorbeltStates[b][1]=!0)}),$(".meteor-check").on("ifUnchecked",function(a){for(var b=0;b<meteorbelts.length;++b)meteorbelts[b][0]==activePlanet&&(mesh=meteorbelts[b][0],visibility(mesh.children[3],!1));for(var b=0;b<planetMeteorbeltStates.length;++b)activePlanet==planetMeteorbeltStates[b][0]&&(planetMeteorbeltStates[b][1]=!1)}),$(function(){$("#moon-radius-slider").slider({min:20,max:40,value:20,step:1,slide:function(a,b){for(var c=0;c<moonPaths.length;++c)if(moonPaths[c][0]==activeMoon){moonOrbitRadiuses[c][1]=b.value,activeMoon.parent.remove(moonPaths[c][1]);var d=addMoonOrbitPath(b.value);activeMoon.parent.add(d),moonPaths[c][1]=d}}})}),$(function(){$("#moon-rotation-slider").slider({min:.1,max:1,value:.1,step:.1,slide:function(a,b){for(var c=0;c<moonSpeeds.length;++c)moonSpeeds[c][0]==activeMoon&&moonSpeeds[c][1]!=b.value&&(0==moonSpeeds[c][4]?moonSpeeds[c][4]=moonSpeeds[c][1]*time:moonSpeeds[c][4]=moonSpeeds[c][4]+(time-moonSpeeds[c][3])*moonSpeeds[c][1],moonSpeeds[c][2]=moonSpeeds[c][1],moonSpeeds[c][1]=b.value,moonSpeeds[c][3]=time)}})}),$(".earth-tex-img").click(function(){updatePlanetTexture("earthmap.jpg")}),$(".alien-tex-img").click(function(){updatePlanetTexture("alien.jpg")}),$(".cloudy-tex-img").click(function(){updatePlanetTexture("cloudy.jpg")}),$(".desolate-tex-img").click(function(){updatePlanetTexture("desolate.png")}),$(".klendathu-tex-img").click(function(){updatePlanetTexture("klendathu.png")}),$(".sandy-tex-img").click(function(){updatePlanetTexture("sandy.jpg")}),$(".scarl-tex-img").click(function(){updatePlanetTexture("scarl.png")}),$(".steel-tex-img").click(function(){updatePlanetTexture("steeltexture.jpg")}),$(function(){$("#accordion").accordion({collapsible:!0,active:!1,animate:"linear",animate:300})}),$(function(){$("#texture-accordion").accordion({collapsible:!0,active:!1,animate:"linear",animate:300})}),$("#add-planet-button").click(function(){user&&(deselect(),selectPlanetsOk=!1,addPlanet(0,0,"","earthmap.jpg",150,1,.001,!1,!1),$(".planet_radius_slider").slider("option","value",150),$(".planet_size_slider").slider("option","value",1),$(".planet_rotation_slider").slider("option","value",.001),menusOnCreatePlanet())}),$("#music-button").click(function(){musicOn?(song1.pause(),document.getElementById("play-pause-icon").className="fa fa-play fa-fw fa-1x",musicOn=!1):(song1.play(),document.getElementById("play-pause-icon").className="fa fa-pause fa-fw fa-1x",musicOn=!0)}),$("#sound-button").click(function(){soundOn?(soundOn=!1,document.getElementById("sound-check-icon").className="fa fa-volume-off fa-fw fa-1x"):(soundOn=!0,document.getElementById("sound-check-icon").className="fa fa-volume-up fa-fw fa-1x")}),$("#add-moon-button").click(function(){addMoon(),buttonsOnAddMoon()}),$("#save_planet_button").click(function(){for(var a=$("#planet-name-field").val(),b=0;b<planetNames.length;++b)planetNames[b][0]==activePlanet&&(planetNames[b][1]=a);selectPlanetsOk=!0,menusOnSave(),menusOnPlanetActive(),updatePlanetInDB()}),$("#edit-planet-button").click(function(){if(user&&editAccess){selectPlanetsOk=!1;for(var a,b=0;b<planetPaths.length;++b)planetPaths[b][0]==activePlanet&&(a=planetOrbitRadiuses[b][1]);for(var c,b=0;b<planetSizes.length;b++)planetSizes[b][0]==activePlanet&&(c=planetSizes[b][1]);for(var d,b=0;b<planetSpeeds.length;b++)planetSpeeds[b][0]==activePlanet&&(d=planetSpeeds[b][1]);$(".planet_radius_slider").slider("option","value",a),$(".planet_size_slider").slider("option","value",c),$(".planet_rotation_slider").slider("option","value",d);for(var b=0;b<planetMeteorbeltStates.length;++b)activePlanet==planetMeteorbeltStates[b][0]&&(planetMeteorbeltStates[b][1]?$(".meteor-check").iCheck("check"):$(".meteor-check").iCheck("uncheck"));menusOnEditPlanet()}else console.log("user has no access to edit this planet")}),$(".delete-planet-button").click(function(){deletePlanetFromDB(),removePlanet(),selectPlanetsOk=!0,jumpPlanetOk&&jumpMoonOk?(solarBools(),buttonsOnViewSystem()):menusOnDeletePlanetSystemView()}),$("#jump-planet-button").click(function(){jumpInAction||(planetBools(),buttonsOnViewPlanet())}),$("#jump-moon-button").click(function(){jumpInAction||(moonBools(),buttonsOnViewMoon())}),$("#jump-system-button").click(function(){jumpInAction||(solarBools(),buttonsOnViewSystem())}),$("#build-planet-button").click(function(){user&&editAccess?(selectPlanetsOk=!1,menusOnBuildPlanet()):console.log(user.getUsername()+" has no access to edit this planet")}),$(".edit-done-button").click(function(){selectPlanetsOk=!0,menusOnEditDone(),updatePlanetInDB()}),$(function(){$("#edit-planet-tabs").tabs()}),$("#jump-system-button").mouseup(function(){$(this).blur()}),$("#jump-moon-button").mouseup(function(){$(this).blur()}),$("#jump-planet-button").mouseup(function(){$(this).blur()}),$("#add-planet-button").mouseup(function(){$(this).blur()}),$("#edit-planet-button").mouseup(function(){$(this).blur()}),$("#add-moon-button").mouseup(function(){$(this).blur()}),$(".edit-done-button").mouseup(function(){$(this).blur()}),$("#build-planet-button").mouseup(function(){$(this).blur()}),$("#music-button").mouseup(function(){$(this).blur()}),$("#sound-button").mouseup(function(){$(this).blur()}),$(".room-container").slideupmenu({slideUpSpeed:150,slideDownSpeed:200,ease:"easeOutQuad",stopQueue:!0}),$("#solar-room").click(function(){changeSolarSystem("Solar System")}),$("#kaiser-room").click(function(){changeSolarSystem("Kaiser Crescent")}),$("#sixten-room").click(function(){changeSolarSystem("Sixten Sigma")}),$("#morbit-room").click(function(){changeSolarSystem("Morbit Nebula")}),$("#k4-room").click(function(){changeSolarSystem("K4 Cluster")})});